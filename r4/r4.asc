r4
i kws32.gif align=left
i kws32.gif align=right
c <A HREF="http://www.kilowattsoftware.com"><strong><font size=4><i>Kilowatt Software L.L.C.</i></font></strong></a>
c <img src=r4tmark.gif>
c <u>R</u>EXX Language Level <u>4</u>.00 (TRL-2)
c <strong>User's Guide</strong>
r
+ Index
p This guide contains the following sections:
U
l <A HREF="#Introduction">Introduction</A>
l <A HREF="#Usage">Usage</A>
l <A HREF="#ProgramSearch">Program search</A>
l <A HREF="#FirstProgram">Writing your first <b>r4&#153;</b> program</A>
l <A HREF="#Examples">Program examples</A>
l <A HREF="#EnvironmentVariables">Environment variables</A>
l <A HREF="#EnvironmentSetup">How to add or revise environment variables</A>
l <A HREF="#ImplementationLimits">Implementation limits</A>
l <A HREF="#PortabilityConsiderations">Portability considerations</A>
l <A HREF="#SpecialCommandRedirections">Special command redirections -- (stack, &lt;queue, and &gt;queue</A>
l <A HREF="#AsciiTable ">Ascii character code table</A>
l <A HREF="#TabsAndSpaces">Tabs and spaces</A>
l <A HREF="#SpecialNotSignCharacter">Special not-sign (&#172;) character</A>
l <A HREF="#R4_PLUS"><b>R4_PLUS</b> -- inter-system extensions</A>
l <A HREF="#StreamBuiltin">Stream builtin function</A>
l <A HREF="#StreamExamples">Stream builtin function examples</A>
l <A HREF="#PreparingBinaryPrograms">Preparing binary programs</A>, with CHILL.REX
l <A HREF="#Remarks">Remarks</A>
l <A HREF="#R4XFORM">R4 to EXE transform program (<b>R4XFORM&#153;</b>)</A>
l <A HREF="TopHat.htm">TopHat form application (<b>TopHat&#153;</b>)</A>
l <A HREF="#Revu">Text file viewing program (<b>Revu&#153;</b>)</A>
l <A HREF="#ProductUpdates">Product updates</A>
l <A HREF="#Support">Support</A>
/
-
A Introduction
+ Introduction:
p <b>r4&#153;</b> is a <i>Classic Rexx</i> language interpreter. This product implements
  features of the REXX language
  as documented in <a href="http://www2.hursley.ibm.com/rexx/trl.html">Michael Cowlishaw's famous book</a>:
~
<PRE>
    The Rexx Language : A Practical Approach to Programming [SECOND EDITION]

    Author: Michael Cowlishaw

    Published in 1990 by Prentice-Hall, Inc.

    ISBN 0-13-780651-5
</PRE>
.

p The book identified above is commonly referenced as <b>TRL-2</b>. <b>r4&#153;</b> implements all REXX
  language features described in TRL-2.
p The TRL-2 book can be obtained at one of the following internet sites:

T cellspacing=10 border=1
l Amazon^<a href="http://www.amazon.com/">http://www.amazon.com/</a>
l Barnes &amp; Noble^<a href="https://www.bn.com/">https://www.bn.com/</a>
l Fat Brain^<a href="http://www.fatbrain.com/">https://www.fatbrain.com/</a>
l SoftPro^<a href="http://www.softpro.com/">https://www.softpro.com/</a>
/

p A new 500 page Rexx book, written by Howard Fosdick, has been published by Wiley (ISBN: <b>0764579967</b>).
  The book describes how to make the best use of Rexx tools
  and interfaces, with examples for both Linux and Microsoft&#174; Windows&#174;. A tutorial is
  provided with lots of examples to help you get up and running with Rexx.
  The book is available at the following online bookstores
  <a href=http://www.amazon.com/exec/obidos/tg/detail/-/0764579967/qid=1108145468/sr=8-1/ref=sr_8_xs_ap_i1_xgl14/102-6587779-3816167?v=glance&s=books&n=507846>Amazon</a>
  and <a href=http://search.barnesandnoble.com/booksearch/isbnInquiry.asp?userid=qq1JJTvAiI&isbn=0764579967&itm=1>Barnes and Noble</a>.

p Some other helpful REXX language internet sites are:

T cellspacing=10 border=1
l Kilowatt Software L.L.C.'s Classic Rexx Tutorial^<a href="http://www.kilowattsoftware.com/tutorial/rexx/" target=_blank>http://www.kilowattsoftware.com/tutorial/rexx/</a>
l Rexx Language page at IBM Hursley^<a href="http://www2.hursley.ibm.com/rexx/">http://www2.hursley.ibm.com/rexx/</a>
l An online Rexx tutorial^<a href="http://www.kyla.co.uk/other/rexx1.htm">http://www.kyla.co.uk/other/rexx1.htm</a>
l An online Rexx tutorial^<a href="http://www.ilook.fsnet.co.uk/index/rexx_idx.htm">http://www.ilook.fsnet.co.uk/index/rexx_idx.htm</a>
l A good source for other Rexx information^<a href="http://www.rexx.org.uk">http://www.rexx.org.uk</a>
l A good source for other Rexx information^<a href="http://www.rexxfiles.com">http://www.rexxfiles.com</a>
/
p TRL-2 defines language capabilities for multiple system environments. The guide your are now viewing
  describes features that are specific to the <b>r4&#153;</b> implementation
  of <i>Classic Rexx</i>. Some features are adaptations associated with the
  Microsoft&#174; Windows&#174; system environments. If you have written Rexx programs in IBM
  mainframe environments you should be aware that Microsoft&#174; Windows&#174; environments use
  <a href=#AsciiTable><b>Ascii</b></a> character encodings, instead of EBCDIC.
p Kilowatt Software L.L.C. provides an extensive online
  <a href="http://www.kilowattsoftware.com/tutorial/rexx/"><i>Classic Rexx</i> Tutorial</a>.
  This tutorial describes all Rexx instructions and built-in functions. There are numerous
  example programs. If you are learning how to write Rexx programs you should spend some
  time reading the online tutorial. You should also obtain the TRL-2 book.
-
A Usage
+ Usage:
p The <b>r4&#153;</b> program operates as a Microsoft&#174; Windows&#174; 32 console application. The following is
  the syntax of a <b>r4&#153;</b> program request, that is entered as a DOS command prompt. There
  are four variations. In the first variation, <b>r4&#153;</b> is the only program that is executed.
  The remaining variations are command pipelines. The vertical bars separate pipeline command segments.

X style='font-weight:bold'
  &nbsp;&nbsp;r4 programName [argumentText] [ &lt; inFile ] [ [&gt;]&gt; outFile ]

<hr width=20% align=left>
  &nbsp;&nbsp;r4 programName [argumentText] [ &lt; inFile ] <span class=special>|</span> programB

<hr width=20% align=left>
b &nbsp;&nbsp;programA <span class=special>|</span> r4 programName [argumentText] [ [&gt;]&gt; outFile ]

<hr width=20% align=left>
b &nbsp;&nbsp;programA <span class=special>|</span> r4 programName [argumentText] <span class=special>|</span> programB
/

p Within this line, <strong>r4</strong> is a request to execute the <b>r4&#153;</b> program,
  which has a file name R4.EXE. You should add the directory that contains R4.EXE to your
  system PATH environment variable. See the <a href=#EnvironmentSetup>environment</a> setup
  section to determine how to revise the PATH environment variable.

p The <b>r4&#153;</b> program can also process
  <a href=#FileRedirection>redirected files</a>.
  The <b>r4&#153;</b> program
  can also participate in
  <a href=#CommandPipeline>command pipelines</a>.
-
+ Required program name argument:
U
l <b>programName</b> .. the name of the REXX program to perform. This can be a partially or fully
  qualified Microsoft&#174; Windows&#174; file name. An optional default extension is assumed.
  The default extension can be defined by setting
  the <b>R4_DEFAULT_PROGRAM_EXT</b> <A HREF="#R4_DEFAULT_PROGRAM_EXT">environment variable</A>.
  If this environment variable is not defined the default extension is: <b>.REX</b>

O
l The following is an example of a fully qualified program name.  
b &nbsp;&nbsp;<strong>c:\r4\copyfile.rex</strong> 

l The following is an example of a fully qualified program that lacks a file extension.
b &nbsp;&nbsp;<strong>c:\r4\copyfile</strong> 

l The following is an example of a partially qualified program name.  
b &nbsp;&nbsp;<strong>copyfile.rex</strong> 

l The following is an example of a partially qualified program name that lacks a file extension.  
b &nbsp;&nbsp;<strong>copyfile</strong>

l The following is an example of a partially qualified program name that has an empty file extension.  
b &nbsp;&nbsp;<strong>copyfile.</strong>
/
/

A ProgramSearch
+ Program search:
p When a fully qualified program name is specified, that program is executed if it exists.

p When a partially qualified program name is specified, a search is conducted for the program. This
  search begins in the current directory, and then proceeds through directories that are defined in
  the <A HREF="#R4PATH">R4PATH<A> environment variable. If a file is found, then that program is executed.
  Otherwise, an additional search is performed for a program with a default program extension.
p <b>Suggestion:</b> always name your REXX program with the default program extension extension, and never create a
  file that has the same name without the extension. If both files exist, you will
  have to specify an explicit program extension with the <b>programName</b> argument of the <b>r4</b>
  command.

p In the first example above, only the fully qualified file name is tried.

p In the second example above, an attempt is made to perform the named file, and then an implicit default
  extension is tried.

p In the third example above, a search is performed for the named file in the current directory, and
  in the directories defined by the R4PATH environment variable.

p In the fourth example above, if an extension-less file named 'copyfile' exists in the current
  directory, or the directories defined by the R4PATH environment variable, then that file will be
  executed. Often this will cause an error message to appear, because the file is not a REXX program.

p In the fifth example above, a search for an implicit default' extension will not be conducted.
-
-
+ Optional additional text arguments:
U
l <b>argumentText</b> .. argument text that is passed to the top level REXX procedure. This text
  includes all spaces and quotes that were present in the command request.

p Argument text is accessed in the REXX procedure by using either the ARG( 1 )
  builtin function, the ARG keyword instruction, or the PARSE ARG keyword instruction.
/
-
A FirstProgram
+ Writing your first <b>r4&#153;</b> program
O
l Start the Notepad accessory

l Enter the following text:
X
l /* HELLO.REX */
l call charout , "Please enter your name: "
l say 'Hello' linein( ! ) '!'
/

l Save the file as <b>HELLO.REX</b> in the same directory that contains R4.EXE (i.e. c:\r4).

l Start a DOS command prompt

U
l In Microsoft&#174; Windows&#174; NT/2000/XP, select 'Run...' from the 'Start' menu, enter 'CMD' in the input field,
  then press the OK button.

l In Microsoft&#174; Windows&#174; 98 and ME, select 'Run...' from the 'Start' menu, enter 'command' in the input field,
  then press the OK button.
/

l At the command prompt enter the two lines shown below:

X style='font-weight:bold'
l cd c:\r4
l r4 hello
/

l Type your name at the prompt, then press the Enter key.

l The greeting should appear.

l You have successfully edited and performed your first <b>r4&#153;</b> program.
/
-
A Examples
+ Program examples
p An assortment of REXX programs are provided for your reference. A summary of these follows:
T
l AnnVal.rex^Compute compounded value of an annuity (used with Bizzy.TopHat form)
l Anova.rex^Analysis of means, standard deviations, and variances
l Anova2.rex^Analysis of means, standard deviations, and variances -- detailed
l Asc2html.rex^Converts a marked up Ascii text file to HTML
l Ascii.rex^Dislays the Ascii character code table
l Box.rex^Encloses input within box characters
l Caldisp.rex^A calendar preparation program
l Caldisp2.rex^A faster calendar preparation program
l ChgAll.rex^replace all occurrences of one string, by another
l ChangeStr.rex^an external procedure that emulates the 'changestr' builtin function -- DEPRECATED.
l CompVal.rex^Perform compound interest computation (used with Bizzy.TopHat form)
l CsvDef.rex^Creates a new comma-separated value (CSV) file (used with CsvDef.TopHat form)
l CsvMaker.rex^Generates a TopHat form, and a REXX program, that adds lines to a CSV file
l Csv2xml.rex^Converts comma-separated value (CSV) files to XML files
l DatePick.rex^Demonstration of program that uses DATEPICK.EXE
l Deal.rex^Deals a hand of cards in Bridge format
l Difference.rex^Computes difference of two sets
l Easter.rex^Calculates Easter
l Factorial.rex^Calculates factorial
l FileDlg.rex^File selection dialog program that uses FILEDLG.EXE
l FinCalc.rex^Financial ratio computations (used with FinCalc.TopHat and FinCalcOut.TopHat forms)
l Gcd.rex^Computes greatest common divisor of two numbers
l GetContact.rex^Get contact information (used with Contact.TopHat form)
l Hanoi1.rex^A 'towers of hanoi' program
l Hanoi2.rex^Animated 'towers of hanoi' program
l HtmlMiner.rex^Extracts text within an HTML file that is not part of a tag
l Intersection.rex^Computes intersection of two sets
l Lcm.rex^Computes least common multiple of two numbers
l LoanCalc.rex^Perform loan computations (used with Bizzy.TopHat form)
l Lottery.rex^Picks 6 lottery numbers
l Matrix.rex^Displays input as a matrix with M rows and N columns
l Messager.rex^Demonstration of program that uses MSGBOX.EXE
l MetricArea.rex^Metric area conversions (used with Metric.TopHat form)
l MetricDistance.rex^Metric distance conversions (used with Metric.TopHat form)
l MetricVolume.rex^Metric volume conversions (used with Metric.TopHat form)
l MetricWeight.rex^Metric weight conversions (used with Metric.TopHat form)
l MetricTemperature.rex^Metric temperature conversions (used with Metric.TopHat form)
l Picker.rex^Demonstration of program that uses PICKLIST.EXE
l Powers2.rex^Shows 'powers of 2' table
l PresVal.rex^Perform present value computation (used with Bizzy.TopHat form)
l Prompter.rex^Demonstration of program that uses PROMPT.EXE
l Qt.rex^Shows the present time in English
l Rexxtry.rex^An interactive REXX shell
l Roman.rex^Converts a number to roman numerals
l Sayit.rex^A tiny full function calculator
l Sieve.rex^Prime number algorithm -- the 'sieve of Eratosthenes' algorithm
l Sqrt.rex^Computes square root using Newton's algorithm -- an external procedure
l Sumdisk.rex^The <b>best</b> example -- summarizes disk space usage
l TopoSort.rex^Topological sort -- dependency analyzer
l Union.rex^Computes union of two sets
/
-
A EnvironmentVariables
+ Environment variables:

p The following environment variables can be specified to customize the execution of <nobr class=roo>r4&#153;</nobr> programs.
  For normal program execution you will not need to define any of these environment variables.
U
b <a href=#LOCALE><b>LOCALE</b></a>
b <a href=#R4_ALLOW_UNQUALIFIED_SOURCE><b>R4_ALLOW_UNQUALIFIED_SOURCE</b></a>
b <a href=#R4_ANSI><b>R4_ANSI</b> -- ANSI-compatibility option</a>
b <a href=#R4_DEFAULT_PROGRAM_EXT><b>R4_DEFAULT_PROGRAM_EXT</b></a>
b <a href=#R4_EXECTRAC><b>R4_EXECTRAC</b></a>
b <a href=#R4_TRACE_procedureName><b>R4_TRACE_procedureName</b></a>
b <a href=#R4COMMANDWAIT><b>R4COMMANDWAIT</b></a>
b <a href=#R4LINEBREAK><b>R4LINEBREAK</b></a>
b <a href=#R4PATH><b>R4PATH</b></a>
b <a href=#R4_PLUS><b>R4_PLUS</b> -- inter-system extensions</a>
b <a href=#R4_STRICT><b>R4_STRICT</b> -- strict and non-strict modes</a>
b <a href=#R4_TRACE_LOCAL><b>R4_TRACE_LOCAL</b> -- confine tracing to current procedure level</a>
/
D
<hr align=left width=40>

A LOCALE
d LOCALE

t If the LOCALE environment variable is set, then that locale is used for collation
  and character handling. The default locale that is used is "English_United States.1252".
  Description of the LOCALE environment variable settings can be found on the internet.

A R4_ALLOW_UNQUALIFIED_SOURCE
d R4_ALLOW_UNQUALIFIED_SOURCE

t <b>r4&#153;</b> optionally requires REXX source programs to begin with a source comment --
  i.e. the first two characters of the first line must be '/*'. This avoids a nuisance,
  when files that do not have an extension, are accidently considered to be REXX programs.
  For example, if you are trying to run program XX.REX, but a data file named XX also exists,
  the data file could be mistakenly processed as the source program. By assuring that
  the file begins with a source comment, the data file will be ignored, and the XX.REX
  program will be properly located instead.
p The optional <b>R4_ALLOW_UNQUALIFIED_SOURCE</b> environment variable controls whether
  checking that REXX programs begin with a source comment is made. When the
  <b>R4_ALLOW_UNQUALIFIED_SOURCE</b> environment variable
  starts with the letter 'N', then files will be checked to ensure that they begin with a comment.
  The following shows the associated command line to enter:

X
  set R4_ALLOW_UNQUALIFIED_SOURCE=N
/
p When the <b>R4_ALLOW_UNQUALIFIED_SOURCE</b> environment variable
  starts with the letter 'Y', then any file will be accepted as a REXX source program.
  The following shows the associated command line to enter:

X
  set R4_ALLOW_UNQUALIFIED_SOURCE=Y
/
p When the <b>R4_ALLOW_UNQUALIFIED_SOURCE</b> environment variable is not set the <b>default</b>
  is to <b>allow</b> source files to be executed, even though they do not begin with a source comment.
p You are <b><i>encouraged</i></b> to define the <b>R4_ALLOW_UNQUALIFIED_SOURCE</b> environment variable to 'N'.
  Otherwise, you might have to debug some perplexing difficulties. For example, if the data file
  XX is empty, <b>r4&#153;</b> will process an empty program. When you look at the source
  of the XX.REX program you will not easily be able to understand why the program is not
  executed. By defining the <b>R4_ALLOW_UNQUALIFIED_SOURCE</b> environment variable to 'N'
  you will not have to endure such aggravation.

<hr align=left width=40>

A R4_ANSI
d <b>R4_ANSI</b> -- ANSI-compatibility option

t The <a href=#ChangeStr>CHANGESTR</a> and <a href=#CountStr>COUNTSTR</a> built-in functions have alternate specifications, ANSI and NetRexx/Roo!&#153;.
  By default <b>r4&#153;</b> supports the <b>ANSI</b> specification of these functions. The alternative
  NetRexx/Roo!&#153; behavior can be established by setting the <b>R4_ANSI</b> environment variable
  to <i>NO</i> (Default: <b>YES</b>).

<hr align=left width=40>
A R4_DEFAULT_PROGRAM_EXT
d R4_DEFAULT_PROGRAM_EXT

t the <b>R4_DEFAULT_PROGRAM_EXT</b> environment variable establishes the default extension that is used
  to locate REXX programs. If this environment variable is not defined, the default extensions that are
  used are: <b>.REX;.CMD</b>
p The <b>R4_DEFAULT_PROGRAM_EXT</b> environment variable can include multiple alternative extensions separated by semicolons -- such
  as:
X
  <b>.rex;rexx;cmd</b>
/
  <i>Note:</i> an implicit period is assumed before an extension.

<hr align=left width=40>

A R4_EXECTRAC
d R4_EXECTRAC

t the <b>R4_EXECTRAC</b> environment variable establishes the trace setting when the main
  procedure is started. The value of the environment variable is processed exactly as though
  the string was the parameter of the <a href="http://www.kilowattsoftware.com/tutorial/rexx/bitrace.htm">
  <b>trace</b></a> built-in function.
p The following causes interactive tracing to be activated, with intermediate results listed.

X
  set R4_EXECTRAC=?i
/

d Redirecting trace output to a file

t Often when you set the R4_EXECTRAC environment variable, you would also like trace output written to a file
  instead of the display. In Microsoft&#174; Windows&#174; XP environments you can <b>redirect trace output</b>
  to a file. This is done as follows:
  
X
  r4 progName &gt; outFile 2&gt;&amp;1
/

p The above redirects the output of <i>progName</i> to <i>outFile</i>. Trace output will also be present in <i>outFile</i>.

<hr align=left width=40>

A R4_TRACE_procedureName
d R4_TRACE_procedureName

t the <b>R4_TRACE_procedureName</b> environment variable establishes the trace setting when a specific
  procedure is invoked. The value of the environment variable is processed exactly as though
  the string was the parameter of the <a href="http://www.kilowattsoftware.com/tutorial/rexx/bitrace.htm">
  <b>trace</b></a> built-in function.
p The following causes interactive tracing to be activated, with intermediate results listed, when the
  <b>factorial_ice</b> procedure is invoked.

X
  set R4_TRACE_factorial_ice=?i
/

<hr align=left width=40>

A R4COMMANDWAIT
d R4COMMANDWAIT

t The optional <b>R4COMMANDWAIT</b> environment variable identifies when R4 should wait for
  the completion of commands. This option is necessary when a command will operate as an interactive
  Microsoft&#174; Windows&#174; application. R4 always waits for the completion of internal system commands; such as, MORE or XCOPY.

p When the first letter of the <b>R4COMMANDWAIT</b> is 'Y', R4 will wait for the completion of
  commands which are Microsoft&#174; Windows&#174; applications. Otherwise, R4 will use the system command processor
  to process the command.

p An example of setting the R4COMMANDWAITenvironment variable value follows:
b &nbsp;&nbsp;set R4COMMANDWAIT=Yes
b This indicates that R4 will wait for the completion of
  commands which are Microsoft&#174; Windows&#174; applications.

<hr align=left width=40>

A LineBreak
d R4LINEBREAK

t The optional <b>R4LINEBREAK</b> environment variable identifies characters that terminate
  lines that are written by the LINEOUT builtin function. The R4LINEBREAK environment variable
  also identifies character line terminators for selector pools that are accessed by the
  VALUE builtin function.

t The R4LINEBREAK environment variable has no effect on the characters that terminate lines that
  are read by the LINEIN builtin function. See the <a href="#LineinTerminators">LINEIN terminators</a>
  section below.

p The default line termination characters are the Microsoft&#174; Windows&#174; standard; an Ascii carriage return
  (decimal 13 -- symbolically <b>\r</b>) followed by an Ascii line feed (decimal 10 -- symbolically <b>\r</b>).

p An example of setting the R4LINEBREAK environment variable value follows:
b &nbsp;&nbsp;set R4LINEBREAK=\n
b This indicates that lines are terminated by an Ascii line feed only.

p The default setting is:
b &nbsp;&nbsp;set R4LINEBREAK=\r\n

p Lines can be terminated by other sequences as well, for example:
b &nbsp;&nbsp;set R4LINEBREAK=&lt;br&gt;
b  Which is the standard HTML line break sequence.

p When backslashes are encountered in the R4LINEBREAK setting, if the next character is neither
  an 'r' nor an 'n', then the next character is included in the line termination sequence. For
  example,
b &nbsp;&nbsp;set R4LINEBREAK=\\r\\n
b Ends each line with the character sequence '\r\n'.

<hr align=left width=40>

A R4PATH
d R4PATH

t The optional <b>R4PATH</b> environment variable identifies a sequence of one or more Microsoft&#174; Windows&#174;
  directories separated by semicolons. These define the directories that will be searched for
  the REXX program that is performed. The <A HREF="#ProgramSearch">Program Search<A> section above
  describes how REXX programs are located.

p If the <b>R4PATH</b> environment variable is not defined, the default path will be the folder (directory)
  that contains the R4.EXE module.

p <i>Note:</i> this environment variable is also used to locate <b>external procedures</b> that are
  invoked by the REXX program.

<hr align=left width=40>

A R4_PLUS
d <b>R4_PLUS</b> -- inter-system extensions

t <b>r4&#153;</b> can provide compatibility with other REXX environments,
  when the <b>R4_PLUS</b> environment variable is set to <b>YES</b> (Default: <i>NO</i>).
  The following additional capabilities are provided:

D
d +1. Assignment instructions without expressions

t Some REXX language processors allow assignment expressions to lack expressions after the equal sign. In this case,
  the variable is set to the empty string. For example,

X
<pre>
  v1 =
  v2 =
  v3 = ''
  parse value with v4 v5 v6
</pre>
/
p All six variables above are initialized to the empty string.

d +2. UPPER instruction

t Some REXX language processors provide the <b>UPPER</b> instruction, which
  converts the value of one or more variables to uppercase. For example,

X
<pre>
  parse value 'abc def ghi' with v1 v2 v3

  UPPER v1 v2 v3
</pre>
/
p The value of variables v1, v2, and v3 are converted to uppercase:
p &nbsp;&nbsp;v1 --&gt; ABC
p &nbsp;&nbsp;v2 --&gt; DEF
p &nbsp;&nbsp;v3 --&gt; GHI

d +3. parse EXTERNAL

t Some REXX language processors use the <b>EXTERNAL</b> keyword with the PARSE instruction. This is equivalent
  to the <i>LINEIN</i> keyword. For example,

X
<pre>
  say 'what is your name ?'

  parse <b>EXTERNAL</b> name

  say 'Hello' name
</pre>
/

d +4. parse NUMERIC

t Some REXX language processors use the <b>NUMERIC</b> keyword with the PARSE instruction. This provides
  the numeric DIGITS, FUZZ, and FORM settings for parsing. For example,

X
<pre>
  parse <b>NUMERIC</b> digits fuzz form

  say 'The current DIGITS setting is:' digits
  say 'The current FUZZ setting is:' fuzz
  say 'The current FORM setting is:' form
</pre>
/
/

<hr align=left width=40>

A R4_STRICT
d <b>R4_STRICT</b> -- strict and non-strict modes

t <b>r4&#153;</b> can provide compatibility with other REXX environments,
  that have <i>relaxed</i> conformance with REXX language specifications.
  This is accomplished by setting the <b>R4_STRICT</b> environment variable
  to <b>NO</b> (Default: <i>YES</i>). In this case, the following is permitted:

X
<pre>
  call fn( arg1, arg2, ... )
</pre>
/
p In <b>strict</b> mode the above would be considered invalid. The proper form
  of the <b>call</b> instruction does not have a left parenthesis immediately
  following the subroutine name. The correct way to call the subroutine is:

X
<pre>
  call fn arg1, arg2, ...
</pre>
/

p By default <b>r4&#153;</b> operates in <b>strict</b> mode.

<hr align=left width=40>

A R4_TRACE_LOCAL
d <b>R4_TRACE_LOCAL</b> -- confine tracing to current procedure level

t <b>r4&#153;</b> can optionally confine tracing to the current procedure level,
  instead of tracing into internal or external procedures. This can be helpful
  when you are trying to locally debug a specific procedure, independently of
  the subroutines or functions that it invokes.
  This is accomplished by setting the <b>R4_TRACE_LOCAL</b> environment variable
  to <b>YES</b> (Default: <i>NO</i>).
/

<hr align=left width=40>

A EnvironmentSetup
+ How to define or revise an environment variable,<br>in Microsoft&#174; Windows&#174; NT/2000/XP
O
l Select 'Settings' of the 'Start' menu.
l Select the 'System' applet on the 'Control Panel',
l Click the 'Environment' tab.
l Locate the variable name in the 'System' or 'User' list if you are revising an existing value.
l Or, enter the variable name in the 'Variable' input field.
l Type or revise the value of the variable in the 'Value' input field.
l Click the 'Set' button.
l Click the 'OK' button.
/

p If you have <b>never</b> revised an environment variable, you might ask a friend or colleague
  who is familiar with this process to help you make this change.
-
+ How to define or revise an environment variable,<br>in Microsoft&#174; Windows&#174; 98 or ME
O
l Edit the C:\AUTOEXEC.BAT file

l If you are adding an environment variable, add a line similar to the following:
T
l &nbsp;&nbsp;<strong>set R4PATH=c:\r4;c:\rexx</strong>
l &nbsp;&nbsp;<strong>set R4LINEBREAK=\n</strong>
/

l If you are revising the PATH or R4PATH environment variable, locate a line similar to the following:
T
l &nbsp;&nbsp;<strong>set PATH=c:\windows;c:\windows\system32
/
p Add the new directory to the path, separating it from other directories by a semicolon.

l Save your changes to the AUTOEXEC.BAT.

l Then, restart your computer so that the AUTOEXEC.BAT file changes will take effect.
/

p If you have <b>never</b> revised the AUTOEXEC.BAT file, you might ask a friend or colleague
  who is familiar with this process to help you make this change.
-
-
A ImplementationLimits
+ Implementation limits:
p <b>r4&#153;</b> implements TRL-2 language features using values that are generally limited by available
  Microsoft&#174; Windows&#174; memory. This means that variable names and values can be very large.
  The NUMERIC DIGITS setting can also be large. The following features are implemented with more finite limits.
O
l The largest C2D result is 18446744073709551615.

l The largest D2C numeric argument is 18446744073709551615. 

l The largest D2X numeric argument is 18446744073709551615.

l The largest X2D numeric argument is 'FFFFFFFFFFFFFFFF'x  => 18446744073709551615.

l File stream accesses are buffered in memory until the <b>r4&#153;</b> program finishes processing.

p Default input stream and default output stream accesses are not buffered. The 'start' value is
  not valid for CHARIN and CHAROUT builtin function requests associated with the default input or
  default output stream. Similarly, the 'line' value is not valid for LINEIN and LINEOUT builtin
  function requests associated with these streams.
/
-
A PortabilityConsiderations
+ Portability considerations:
O
l The Microsoft&#174; Windows&#174; environment uses text characters that are encoded in the Ascii representation. This
  differs significantly from the EBCDIC representation that is used on IBM mainframe computers. The
  following is the character layout of the Ascii representation:

A AsciiTable
<table cellspacing= 5 border=1><tr><th>Ascii table</th></tr>
<tr><td>
<pre>
      0   1   2   3   4   5   6   7   8   9   A   B   C   D   E   F   
  00  NUL SOH STX ETX EOT ENQ ACK BEL BS  HT  LF  VT  FF  CR  SO  SI  
  10  DLE DC1 DC2 DC3 DC4 NAK SYN ETB CAN EM  SUB ESC FS  GS  RS  US  
  20  spc !   "   #   $   &#37;   &amp;   '   (   )   *   +   ,   -   .   /   
  30  0   1   2   3   4   5   6   7   8   9   :   ;   <   =   >   ?   
  40  @   A   B   C   D   E   F   G   H   I   J   K   L   M   N   O   
  50  P   Q   R   S   T   U   V   W   X   Y   Z   [   \   ]   ^   _   
  60  `   a   b   c   d   e   f   g   h   i   j   k   l   m   n   o   
  70  p   q   r   s   t   u   v   w   x   y   z   {   |   }   ~   DEL 
</pre>
</td></tr><tr><td>'spc' indicates a space.
</td></tr><tr><td>Entries in this table are determined by taking the two hexadecimal digits at
  the left hand side of the table, and adding the hexadecimal value at the top of the table.
</td></tr><tr><td>The letter X is in the row that starts with 50, and column 8. Thus, the Ascii
  value of X is hexadecimal 58.
</td></tr><tr><td>The letter O is in the row that starts with 40, and column F. Thus, the Ascii
  value of O is hexadecimal 4F.
</td></tr><tr><td>Character values less than hexadecimal 20 are control characters. HT ('09'x)
  is a horizontal tab, which is commonly referred to as a tab. LF ('0A'x) is a line feed character.
  CR ('0D'x) is a carriage return.
</td></tr><tr><td>'DEL' ('7F'x) is a rubout control character.
</td></tr><tr><td>Character values in excess of hexadecimal 7F are extended Ascii characters, these
  are omitted in the above table because of their effect on HTML browsers.
  You can execute the ASCII.REX program to view extended Ascii characters.
</td></tr></table>
p <i>Note:</i> uppercase letters are <b>less than</b> lowercase letters in collating order. This
  can be significant during string comparisons -- i.e. the Compare built-in function,
  and comparison operators (=, &lt;=, etc.). Consequently, 'Bob' will be considered less than
  'bill' when character case is significant.
p The sequence of lower case Ascii characters can be generated by the XRANGE builtin function as
  follows:
T
l &nbsp;&nbsp;<strong>xrange( 'a', 'z' )</strong>
/

p A text value can be converted to lower case by using the XRANGE and TRANSLATE builtin functions as
  follows:
T
l &nbsp;&nbsp;<strong>lowercaseValue = translate( textValue, xrange( 'a', 'z' ), , xrange( 'A', 'Z' ) )</strong>
/

A TabsAndSpaces
l Tab characters within text values are problematic, as these have an appearance similar to
  spaces. The <b>r4&#153;</b> implementation attempts to treat tabs as equivalent to spaces for
  most circumstances where spaces have special meaning; such as, the <b>WORD...</b> set of builtin functions.
  Tabs are also considered equivalent to spaces within the value that is parsed by the <b>PARSE</b>,
  <b>ARG</b>, and <b>PULL</b> keyword instructions. You can parse for an explicit tab character
  in the <b>PARSE</b>, <b>ARG</b>, and <b>PULL</b> keyword instructions by specifying '09'x in
  the parse template.

A SpecialNotSignCharacter
l The standard character that is supported for the <b>not</b> operator is a backslash ('\'). A backslash is
  the only <b>not</b> operator character that is recommended in Ansi REXX. <b>r4&#153;</b> also accepts
  the Ascii code page 37 'AA'x character (&#172;) as an alternate not-sign character. If you are porting
  programs to/from mainframe environments, then you should ensure that the mainframe not-sign character ('5F'x)
  is converted to an Ascii 'AA'x character. You can make this character appear like a not-sign character in
  your programs if you set your editor's font to OEM Fixed.
  
l A non-standard character that is supported for the <b>not</b> operator is a forward slash ('/'). A backslash is
  the only <b>not</b> operator character that is recommended in Ansi REXX. <b>r4&#153;</b> also accepts
  the forward slash for compatibility with programs written for mainframe environments. The forward slash
  is only treated as a not operator when used in combination with other comparison operators (see list below).
  The forward slash is <b>not accepted</b> as a <b>prefix operator</b>.
T
l /=^not equal
l /&lt;^greater than or equal
l /&gt;^less than or equal
l /==^strictly not equal
l /&lt;&lt;^strictly greater than or equal
l /&gt;&gt;^strictly less than or equal
/
  
l When the first word of a command is the name of an R4 program, the program is invoked as an external
  procedure. The remainder of the command line is passed as the first and only argument of the
  external procedure. For example:
b &nbsp;&nbsp;'execio * diskr INDD (LIFO OPEN FINIS'
b
b Invokes EXECIO.REX as an external procedure, if EXECIO.REX can be located by a <a href=#R4PATH>procedure search (R4PATH)</a>.   

b <i>Observe:</i> if the first word of a command is associated with an .EXE or .BAT file that can be located in
  any directory (folder) that is defined in the PATH environment variable, then the EXE or BAT file is invoked
  instead of the external procedure. This avoids a recursion problem that might occur if the REXX external procedure
  tried to invoke an EXE or BAT file with the same name as the procedure. This problem was reported !
    
l R4 allows an external procedure to begin with the <b>PROCEDURE</b> instruction.
  This enables exposure of the caller's variables to the external procedure. In addition, the <b>EXPOSEALL</b>
  keyword is supported on the PROCEDURE instruction.
b
b The example EXECIO.REX program uses the EXPOSEALL keyword, in order to reference or revise
  the caller's stem variables.

l The TRL-2 book does not specify the following capabilities that are found in some REXX
  programming environments:
T
l MAKEBUF command
l DROPBUF command
l NEWSTACK command
l DELSTACK command
l EXECIO command
/
b All of the above commands, except EXECIO, are implemented internally within <b>r4&#153;</b>. The EXECIO command
  is supported in EXECIO.REX, which is an external procedure that executes as a command.

l The positional values associated with the <b>SOURCE</b> option of the <b>PARSE</b> keyword instruction are:
T
l <b>Win32</b>^(always)
l <b>COMMAND</b>, <b>FUNCTION</b>, or <b>SUBROUTINE</b>
l full file name, with spaces replaced by carets^i.e. <b>C:\R4\HELLO.REX</b>
l <b>*</b>^(always
l <b>*</b>^(always)
l invocation name^i.e. <b>HELLO</b>
/
p Note: all of the above values are in UPPERCASE, with the exception of the leading 'Win32' value.

l The value associated with the <b>VERSION</b> option of the <b>PARSE</b> keyword instruction is:
T
l REXX-r4 4.00 dd Mon yyyy
l where: <b>dd</b> is build day, <b>Mon</b> is build month, <b>yyyy</b> is build year
/

A LineinTerminators
l Lines that are read by the <b>LINEIN</b> builtin function are terminated when one of the
  following Ascii character sequences is discovered:
T
l carriage return THEN line feed^decimal 13, decimal 10
l line feed THEN carriage return^decimal 10, decimal 13
l line feed only^decimal 10
l carriage return only^decimal 13
/
p This allows your programs to easily process text files that are received from other system
  environments; such as, UNIX, or Linux.

l The CHARIN builtin function obtains all character values, including line terminators, exactly
  as these arrive from the input stream.

l The CHAROUT builtin function writes all character values, including line terminators, exactly
  as these are passed in the <b>string</b> value. Isolated line feed or carriage return characters
  are <b>not</b> converted to a carriage return THEN line feed sequence, as performed by other
  programming languages.

l When the <b>selector</b> option of the <b>VALUE</b> function is specified, it is interpreted as follows:

U
l If the <b>selector</b> option is 'system', then values are associated with environment variables
  of the R4 program scope. Revisions to environment variables will be seen by commands started by
  R4. These revisions are lost when the R4 program concludes. Thus, R4 programs can not permanently
  alter environment variables.

p The <a href="#EnvironmentVariableAccess">environment variable access</a> section below shows how to set and reference environment variable values.

l The 'registry' <b>selector</b> option is used to access and revise system registry values.
  Revisions to registry values are permanently altered.

p The <a href="#RegistryValueAccess">registry value access</a> section below shows how to access and revise system registry values.

l Any other <b>selector</b> option is considered to be the name of a file. If the file name
  does not have a backslash, then the file is stored in the same directory as R4.EXE. Values are
  stored when the R4 program terminates. These values are restored when the selector pool
  with the same name is referenced in a subsequent R4 program execution.
  
p <i>Observe:</i> if <b>temporary</b> is contained anywhere within the name of the selector pool
  then values are not saved when the R4 program terminates.
/

l Interactive trace requests can not exceed 255 characters.

l The only supported address associated with the <b>ADDRESS</b> keyword instruction is:
b &nbsp;&nbsp;<b>'system'</b>
b which is the Microsoft&#174; Windows&#174; system command interpreter.

p Commands sent to the system can include file redirections, and command pipelines. For example:
X style='font-weight:bold'
l 'dir *.rex | r4 countlines &gt;&gt; outfile'
/
p As mentioned previously, you should consult Microsoft&#174; Windows&#174; documentation for the use of file redirection
  and command pipelines. 

p When you perform commands, you should make sure that the <b>&lt;</b>, <b>&gt;</b>, and <b>|</b> characters are enclosed
  within quotes. Otherwise, these will be treated as LESS THAN, GREATER THAN, or OR operator requests.

l External procedures are programmed in REXX only -- EXEs are not invoked.

l The trace marker &gt;A&gt; indicates variable assignment.

l Trace markers &gt;V&gt; and &gt;A&gt; show the associated variable name in square brackets at the end of the trace output line.

A SpecialCommandRedirections
l R4 supports the special <b>"(stack"</b> command line directive. The end of a command is compared with the characters
  " (stack", which can include upper case characters. When this special directive is specified, the command's standard
  output lines are queued to the R4 external data queue.

p Note: the output of the command is redirected to an implicit temporary file. When you use the "(stack" directive,
  you must avoid using the '&gt;' file redirection operator elsewhere within the command.

p The following is an example of the use of the <b>"(stack"</b> command line directive.

X
l 'dir *.rex (stack'
l say queued()
l do queued()
l   parse pull qline
l   say qline
l end
/

l Similarly, R4 supports special <b>"&lt;!queue"</b> and <b>"&gt;!queue"</b> command redirection requests, each of which may include
  upper case characters.
  When the <b>"&lt;!queue"</b> directive is specified, contents of the external data queue are passed to the command's standard
  input stream.
  When the <b>"&gt;!queue"</b> directive is specified, the command's standard
  output lines are queued to the R4 external data queue.

p As with the <b>"(stack"</b> directive, implicit temporary files are used for
  <b>"&lt;!queue"</b> and <b>"&gt;!queue"</b> command redirection requests. You
  you must avoid using the '&lt;' elsewhere within the command if the
  <b>"&lt;!queue"</b> directive is specified. And, you
  you must avoid using the '&gt;' elsewhere within the command if the
  <b>"&gt;!queue"</b> directive is specified.

p The following is an example of the use of <b>"&lt;!queue"</b> and <b>"&gt;!queue"</b> command redirection requests.

X
<pre>
  'newstack'

  /* prepare 10 random numbers between 1 and 99 in the external data queue */

  do 10
    push right( random( 1, 99 ), 2, '0' )
    end

  'sort &lt;!queue &gt;!queue' /* sort the numbers ! */

  /* after the above command completes the numbers are now sorted ! */

  /* show the sorted numbers */

  do queued()
    parse pull qline
    say qline
    end

  'delstack'
</pre>
/

l The <b>HALT</b> condition is activated, from the keyboard, by pressing either the <b>Ctrl</b> and the <b>C</b> keys simultaneously,
  or by pressing the <b>Ctrl</b> and the <b>Break</b> keys simultaneously. There are two <b>Ctrl</b> keys, on either
  side of the space bar. The <b>Break</b> key is usually near the top right of the keyboard.
  
p The REXXTRY.REX example shows how the <b>HALT</b> condition can be handled.

l When a <b>'1A'X</b> character is written to the default output stream
  it acts as an explicit <b>end of file</b> character. This is standard
  operational behavior for Microsoft&#174; Windows&#174; system environments. This impacts output that is written to the console,
  to a redirected file, or in command pipeline redirections. Subsequent output written to the default output stream
  is not transferred.

  A '1A'X character can be written to output streams that are associated with disk files. Subsequent output will
  appear in the disk files.
/
A EnvironmentVariableAccess
+ Environment variable access
p The following shows how the <b>VALUE</b> function is used to set and reference environment variable values.

X style='font-weight:bold'
l /* DOENV.REX */
l call value 'magic', 'abracadabra', 'system' /* set magic environment variable */
b
l say value( 'magic', , 'system' ) /* get magic environment variable */
/
-

A RegistryValueAccess
+ Registry value access
p Access to system registry information allows <b>r4&#153;</b> to prepare and reference information
  that is used by other system software. This is a powerful capability. However, since system registry
  information is critical to correct system operation, <b>r4&#153;</b> can only perform some
  registry operations. You should be particularly careful when revising
  registry values. Erroneous revisions can have <strong>serious consequences</strong>. These
  changes cannot be undone.

p Due to the sensitivity of system registry information, <b>r4&#153;</b> can only be used to access
  and revise registry <em>values</em>. The product does not provide capabilities for accessing
  registry keys directly, and registry keys and values can not be removed. All registry values that
  are accessed by <b>r4&#153;</b> must be strings. No other registry value format is supported.

p As an extra precaution, registry <em>revisions</em> are only permitted when the <b>R4REGISTRYWRITE</b>
  environment variable has value: 'Y'. You can locally alter this value, as shown in the example
  below. No error occurs if this environment variable has not been set.

p You are strongly advised to <strong>B-A-C-K-U-P</strong> the system registry before attempting
  to revise it with an R4 program.

p If you are unfamiliar with the detailed characteristics of the system registry, you should
  discuss what you plan to do with a business colleague or friend, BEFORE attempting to
  revise registry information.  

p Registry values are accessed using a three part name, that has the following structure:
b &nbsp;&nbsp;<b>root\keyPath[valueName]</b>

p The <b>keyPath</b> consists of a hierarchy of keys separated by backslashes.

p The <b>valueName</b> must be enclosed in square brackets.

p The <b>root</b> must be one of the following:
b &nbsp;&nbsp;'HKEY_CLASSES_ROOT'
b &nbsp;&nbsp;'HKEY_CURRENT_USER'
b &nbsp;&nbsp;'HKEY_LOCAL_MACHINE'
b &nbsp;&nbsp;'HKEY_USERS'
b &nbsp;&nbsp;'HKEY_CURRENT_CONFIG'
b &nbsp;&nbsp;'HKEY_DYN_DATA'

p The following root aliases are supported:
T
l &nbsp;'HKCU'&nbsp;^HKEY_CURRENT_USER
l &nbsp;'HKLM'&nbsp;^HKEY_LOCAL_MACHINE
l &nbsp;'HKCR'&nbsp;^HKEY_CLASSES_ROOT
l &nbsp;'HKU'&nbsp;^HKEY_USERS
l &nbsp;'HKCC'&nbsp;^ HKEY_CURRENT_CONFIG
l &nbsp;'HKDD'&nbsp;^HKEY_DYN_DATA
/
p The following shows how the <b>VALUE</b> function is used to access and revise system registry values.

X style='font-weight:bold'
l /* DOREG.REX */
b
l root = 'HKEY_CURRENT_USER'
l keypath = 'Software\Kilowatt Software\DoReg'
l regvalue = 'Magic'
b
l /* enable registry revision */
l call value 'R4REGISTRYWRITE', 'Y', 'system' /* set R4REGISTRYWRITE=Y */
b
l /* revise registry value */
l call value root'\'keypath'['regvalue']', 'abracadabra', 'registry'
b
l /* disable registry revision */
l call value 'R4REGISTRYWRITE', 'N', 'system' /* set R4REGISTRYWRITE=N */
b
l /* registry values can still be retrieved */
b
l /* get registry value */
l say value( root'\'keypath'['regvalue']', , 'registry' )
/
-

-
A StreamBuiltin
+ STREAM builtin function
p The implementation of the STREAM builtin function is customized to the Microsoft&#174; Windows&#174; system environment.
  <b>r4&#153;</b> supports the following STREAM syntax, that conforms with TRL-2:

T
l &nbsp;&nbsp;<strong>STREAM( name, [operation, [streamcommand option] )</strong>
/

p <b>name</b> is the name of the item associated with the request, which may be a stream, a file name,
  a directory name, and so forth.

p <b>operation</b> is either <b><u>C</u>ommand</b>, <b><u>D</u>escription</b>, or <b><u>S</u>tate</b>.
  All are treated as described in TRL-2.

p <b>streamcommand</b> is the name of the stream associated with the request. These are interpreted
  as described in the table below. The character case of the stream command is insignificant. Thus,
  chdir, CHDIR, and ChDir are equivalent.

p <b>option</b> is optional text associated with the <b>streamcommand</b>.

+ Supported STREAM commands
p The following table summarizes the supported stream commands. You should study the STREAM
  <a href="#StreamExamples">examples</a>
  below to gain an improved understanding of these requests.
T
h Stream command^Description^Name^Option
l chdir^Changes active directory^Directory name<sup>1</sup>^N/A
l chdisk^Changes active disk^Disk name<sup>2</sup>^N/A
l close^Closes a specific stream^Stream name^N/A
l dirs^Queues directories<sup>3</sup> under the active directory^Directory pattern<sup>4</sup>^N/A
l drive^Gets disk drive information<sup>5</sup>^Drive name^N/A
l drives^Queues all disk drive information<sup>6</sup>^N/A^N/A
l exists^Returns '1' if a file exists, otherwise '0'^File or directory name^N/A
l fileinfo^Gets file information<sup>7</sup>^File name^N/A
l files^Queues file information<sup>8</sup>^File pattern<sup>9</sup>^N/A
l getkey^Gets a two byte keystroke combination from the console<sup>10</sup>^N/A^N/A
l isdir^Returns '1' if the name is a directory, otherwise '0'^File or directory name^N/A
l linebreak^Sets line break characters for specific stream^Stream name^line break characters<sup>11</sup>
l longname^Shows long name associated with file or directory^Stream name^N/A<sup>12</sup>
l purge^Erases file if not open. Sets read/write positions to 0 if open.<sup>13</sup>^Stream name^N/A
l recycle^Sends file to recycle bin.<sup>14</sup>^Stream name^N/A
; l pop^Pops <b>stdin</b> or <b>stdout</b> to prior stream^N/A^<b>'stdin'</b> or <b>'stdout'</b>
; l push^Pushs <b>stdin</b> or <b>stdout</b><sup>10</sup> and associates new stream^New stream name^<b>'stdin'</b> or <b>'stdout'</b>
l shortname^Shows short name associated with file or directory^Stream name^N/A<sup>15</sup>
/

p <sup>1</sup> If the CHDIR request succeeds it returns the name of the previous directory
  associated with the current disk. If the CHDIR request FAILS, it returns the empty string.
p If the directory name is absent, the CHDIR request returns the currently active directory
  associated with the current disk.

p <sup>2</sup> If the CHDSK request succeeds it returns the name of the previously active disk.
  If the CHDSK request FAILS, it returns the empty string.
p If the disk name is absent, the CHDISK request returns the currently active disk.

p <sup>3</sup> The DIRS request returns the number of directories that were located. Directory
  names are stored in the external data queue, and are accessed by using PARSE PULL for the
  number of directories that were located.

p <sup>4</sup> If the directory pattern is absent, the DIRS request returns all directories under the active directory.

p <sup>5</sup> The DRIVE request gets information describing a specific disk drive. The information has the following
  format.

T
l &nbsp;&nbsp;<strong>driveLetter driveType totalSpace freeSpace clusterSize activeDirectory</strong>

l If disk space information is unavailable, then <i>totalSpace</i>, <i>freeSpace</i>, and <i>clusterSize</i> are all underscores.
/

p <sup>6</sup> The DRIVES request returns the number of disk drives that were located. Disk
  drive information is stored in the external data queue, and is accessed by using PARSE PULL for the
  number of disk drives that were located. Each line of drive information returned by a DRIVES
  request has the same format as a DRIVE request.

p <sup>7</sup> The FILEINFO request gets information describing a specific file. The information has the following
  format.

T
l &nbsp;&nbsp;<strong>fileModificationDateAndTime dirOrSize accessability</strong>
/

p The <b>fileModificationDateAndTime</b> value is formatted as YYYY/MM/DD-HH:MM:SS

p The <b>dirOrSize</b> value is 'DIR' if the file is a directory, otherwise it is the number of
  bytes withinin the file.

p The <b>accessability</b> value is 'RW' if the file is writeable, and 'RO' if the file is read-only.

p <sup>8</sup> The FILES request returns the number of files that were located. File names
  are stored in the external data queue. The names can be acquired by using PARSE PULL for the
  number of files that were located.

p <sup>9</sup> If the file pattern is absent, the FILES request returns all files under the active directory.

; p <sup>10</sup> The <b>stdout</b> option value can be followed by the word <u>A</u>ppend
;   (only the first character is significant). This indicates
;   that output text will be appended to an existing file. By default, output text replaces the contents
;   of an existing file.

p <sup>10</sup> The GETKEY request returns a two byte hexadecimal literal associated with a console keystroke;
  such as, F1, F2, or an arrow key. The values that are returned do not follow a particular pattern. Thus, the
  following quote is appropriate:

X
  Life is like a box of chocolates - you never know what you're going to get.  [Tom Hanks, as Forrest Gump in "Forrest Gump" (1994)]
/
p The GETKEY example below provides a simple program that you can use experimentally to determine the values that are returned for
  specific console keystrokes.
p <i>Hint:</i> The first character is '00'x or 'E0'x when a function key, or a special key is pressed.

p <sup>11</sup> The LINEBREAK option string is formatted as described in the <a href="#LineBreak">R4LINEBREAK</a> section above.

p <sup>12</sup> The stream name can be a short MS-DOS 8.3 name of a file or directory. The corresponding long name is returned.

p <sup>13</sup> The operation of a PURGE request depends on whether the file is currently open or not.

U
X
U
l If the file is <b>not open</b>:
p &nbsp;&nbsp;the file is <b>erased</b> if it exists and "1" is returned.
p &nbsp;&nbsp;if the file doesn't exist "0" is returned.

l If the file is <b>open</b>:
p all current contents are removed, a subsequent write will start at the beginning.
p "1" is always returned if the file is open when the purge request is performed.
/
/
/  

p <sup>14</sup> A RECYCLE request implicitly fully-qualifies the file name.
  It is recommended that the file name parameter be fully-qualified.
  You should also consider prompting before sending files to the recycle bin.
p The following values are returned from a recycle request.

T
l 0^The file was sent to the recycle bin.
l 1^An error occurred sending the file to the recycle bin. The file might be currently open.
/  

p <sup>15</sup> The short name of a file or directory is in MS-DOS 8.3 format.
-  

A StreamExamples
+ STREAM builtin function examples
p The following are examples of STREAM builtin function usage. You can copy the text within these
  examples and paste it into your REXX programs.

X style='font-weight:bold'
l /* CHDIR example */
l subdirectoryName = arg(1)
l if stream( subdirectoryName, 'C', '<b>ChDir</b>' ) &lt;&gt; '' then
l &nbsp;&nbsp;'dir *.rex'
/

X style='font-weight:bold'
l /* CHDSK example */
l targetDisk = arg(1)
l if stream( targetDisk, 'C', '<b>ChDisk</b>' ) &lt;&gt; '' then
l &nbsp;&nbsp;'tree'
/

X style='font-weight:bold'
l /* DISKTELL.REX */
l say "Current disk:"  <b>stream</b>( '', 'C', '<b>ChDisk</b>' )
l say "Current directory:"  <b>stream</b>( '', 'C', '<b>ChDir</b>' )
/

X style='font-weight:bold'
l /* DIRS.REX */
l ndirs = <b>stream</b>( arg(1), 'c', '<b>dirs</b>' )
l 
l do i=1 to ndirs
l &nbsp;&nbsp;pull directory
l &nbsp;&nbsp;say directory
l &nbsp;&nbsp;end
/

X style='font-weight:bold'
l /* DRIVES.REX */
l ndrives = <b>stream</b>( "", 'c', '<b>drives</b>' )
l 
l do i=1 to ndrives 
l &nbsp;&nbsp;pull drive
l &nbsp;&nbsp;say drive
l &nbsp;&nbsp;end
/

X style='font-weight:bold'
l /* DRIVE.REX */
l drive = arg(1)
l if drive = '' then
l &nbsp;&nbsp;call drives /* invoke external procedure DRIVES.REX (see above) */
l else
l &nbsp;&nbsp;say <b>stream</b>( drive, 'c', '<b>drive</b>' )
/

X style='font-weight:bold'
l /* EXISTS.REX */
l file = arg(1)
l if <b>stream</b>( file, 'c', '<b>exists</b>' ) then
l &nbsp;&nbsp;say 'Yea! File' file 'exists.'
l else
l &nbsp;&nbsp;say 'File' file 'DOES NOT exist.'
/

X style='font-weight:bold'
l /* FILES.REX */
l nfiles = <b>stream</b>( arg(1), 'c', '<b>files</b>' )
l 
l do i=1 to nfiles
l &nbsp;&nbsp;pull file
l &nbsp;&nbsp;say left( fileName, max( length( fileName ), 40 ) ) stream( fileName, 'C', 'fileInfo' )
l &nbsp;&nbsp;end
/

X style='font-weight:bold'
l /* FILEINFO.REX */
l file = arg(1)
l say <b>stream</b>( file, 'c', '<b>fileinfo</b>' )
/

X style='font-weight:bold'
l /* FILEDATE.REX */
l file = arg(1)
l say word( <b>stream</b>( file, 'c', '<b>fileinfo</b>' ), 1 )
/

X style='font-weight:bold'
l /* FILESIZE.REX */
l file = arg(1)
l say word( <b>stream</b>( file, 'c', '<b>fileinfo</b>' ), 2 )
/

X style='font-weight:bold'
l /* GETKEY.REX */
l call charout !, 'Press a console keyboard character: '
l say c2x( <b>stream</b>( !, 'c', '<b>getkey</b>' ) )
/

X style='font-weight:bold'
l /* ISDIR.REX */
l dir = arg(1)
l if <b>stream</b>( dir, 'c', '<b>isdir</b>' ) then
l &nbsp;&nbsp;say dir 'is a directory.'
l else
l &nbsp;&nbsp;say dir 'IS NOT a directory.'
/

; X style='font-weight:bold'
; l /* DIRSORT.REX */
; l 
; l 'dir /b *.rex | sort >sorted'
; l 
; l call <b>stream</b> "sorted", "C", "<b>push</b> stdin"
; l call <b>stream</b> "dirsort.out", "C", "<b>push</b> stdout a"
; l 
; l do lno=0 while lines() > 0
; l &nbsp;&nbsp;say linein()
; l &nbsp;&nbsp;end
; l 
; l call <b>stream</b> "", "C", "<b>pop</b> stdin"
; l call <b>stream</b> "", "C", "<b>pop</b> stdout"
; l 
; l say "Finished writing" lno "lines to file 'dirsort.out'"
; /

X style='font-weight:bold'
l /* LINEBREAK.REX */
l file = arg(1)
l call <b>stream</b> file, 'c', <b>'linebreak'</b> \n'
/

X style='font-weight:bold'
l /* LONGNAME.REX */
l file = arg(1)
l longName = <b>stream</b>( file, 'c', <b>'longname'</b> )
/

X style='font-weight:bold'
l /* PURGE.REX -- external procedure
l     if file is not open it is erased
l     if file is open the contents are removed.
l  */
l file = arg(1)
l call <b>stream</b> file, 'c', <b>'purge'</b>
/

X style='font-weight:bold'
<pre>
  /* RECYCLE.REX -- external procedure
    sends file to the recycle bin
    
   A message box is displayed with style value of 292 (4 + 32 + 256):

    show 'Yes' and 'No' buttons                     4
    the 'question mark' icon is displayed       +  32
    the 'No' button initially has the focus     + 256
                                                =====
                                           total: 292
   */

  file = arg(1)

  'MsgBox' '"/CRecycle' file '?" /S292 Are you sure you want to recycle' file '?'

  if rc = 6 then do

    cc = <b>stream(</b> file, 'c', <b>'recycle' )</b>

    if cc = 0 then
      say "'"file"' was sent to the recycle bin."
    else
      say "An error occurred recycling file'"file"'. The file may be open."
    end    
</pre>
/

X style='font-weight:bold'
l /* SHORTNAME.REX */
l file = arg(1)
l shortName = <b>stream</b>( file, 'c', <b>'shortname'</b> )
/
-

-

A PreparingBinaryPrograms
+ Preparing binary programs, with CHILL.REX
p There are various occasions when you will want to convert <span class=point10sem>r4&#153;</span>
  source programs to binary equivalents, so that others can use
  your program without being able to <i>see</i> your logic. Some
  algorithms are copyrighted with provisions that you can
  distribute them to others as long as the source is unreadable.
  The <b>CHILL.REX</b> program allows you to do prepare binary programs
  that can be executed, without associated visible source.
+ Executing CHILL.REX
p The process of converting a REXX program to a 'chilled' binary file
  is fairly simple. Here are several examples
X
<pre>
  r4 chill myCoolProgram.rex

  r4 chill myCool.rooProgram

  r4 chill myCoolClass.roo
</pre>
/
+ The .\ice subdirectory contains 'chilled' programs
p Chilled programs <small>(aka _ice files)</small> are created in the .\ice subdirectory. Chilled
  programs have the same name and extension as the original file, with
  '_ice' added before the extension. For example, if the original program
  is named:
X
<pre>
    myCoolProgram.rex
</pre>
/
p then, the chilled program will be in the .\ice subdirectory with the following name:
X
<pre>
    myCoolProgram_ice.rex
</pre>
/
-
+ The .\iceSource subdirectory contains source of 'chilled' programs
p When a program is chilled it is imperative to retain the corresponding
  source program. This allows you to debug problems when 'chilled' programs
  are used on other systems. The corresponding source files are saved 
  in the .\iceSource subdirectory. The saved source programs have the same
  name and extension as the original file, with a date and time suffix
  added before the extension. For example, if the original program
  is named:
X
<pre>
    myCoolProgram.rex
</pre>
/
p then, the saved source file program will be in the .\iceSource subdirectory with the following name:
X
<pre>
    myCoolProgram_030326_105756.rex
</pre>
/
p Saved source files are created with the read-only attribute. This is a precaution to avoid
  accidental renaming or removal.
p <i>Warning:</i> you should <b>backup</b> saved source files files on alternate media .. i.e. CD-ROM.
-
+ Log of 'chilled' programs
p The CHILL.REX program keeps a log of all requests in file <b>CHILL.LOG</b>.
  The log file is maintained in the active working directory when CHILL.REX is started.
  When you need to find which saved source file corresponds with a specific '_ice'
  file you can locate the associated information in the CHILL.LOG file as follows:
O
l Search for the name of the '_ice' file
l Make sure the file date and time match the '_ice' files date and time
l The name of the corresponding source file is contained on the same line
/
-
+ Other CHILL.REX considerations
U
l The related CHILL.EXE program performs the associated encryption.
l There is no means of thawing a chilled program.
l When chilled programs are executed, the SOURCELINE built-in function shows:
X
p &nbsp;&nbsp;'sourceFile_ice.rex #N .. source is unavailable'
p or,
p &nbsp;&nbsp;'sourceFile_ice.rooProgram #N .. source is unavailable'
p or,
p &nbsp;&nbsp;'sourceFile_ice.roo #N .. source is unavailable'
/
l Similar, output is displayed when errors occur, or during trace output.
l You can 'trace' the activities of chilled programs, by using the following
  environment variables.
p <a href=#R4_EXECTRAC>R4_EXECTRAC</a>
p <a href=#R4_TRACE_procedureName>R4_TRACE_procedureName</a>
/
-
-

A Remarks
+ Remarks:

O
l <span style='color:#c00000'><b>If you are going to use stream output to replace the contents of an existing file,
  you probably want to <strong>ERASE</strong> the file beforehand. Otherwise, if the new content is
  less extensive than the file's prior contents, then some of the prior contents
  will remain at the end. This phenomenon is quite surprising when you first encounter it.</b></span>

l The MS-DOS&#174; environment supported various <i>escape</i> sequences for changing the screen via
  the ANSI.SYS driver. Among the escape sequences was the ability to alter the foreground color of
  text, and the corresponding background color. When text is written to the display (via CHAROUT,
  LINEOUT, or SAY) <b>r4&#153;</b> emulates the ANSI.SYS escape
  sequences that alter text foreground and background color. A text escape sequence is coded as 
  '1B'x (ESC), followed by '[', a series of decimal numbers separated by semicolons, and concludes with a
  lower case 'm'. The following shows the word <b>Hello</b> with a yellow foreground color, and
  a black background color.
  
T
l &nbsp;&nbsp;ESC = '1B'x
l &nbsp;&nbsp;call charout , ESC'[33;40m' || 'Hello'
/

p The following tables identify the numeric values associated with foreground and background colors.

U
<table cellspacing= 5 border=1><tr><th colspan=2>Foreground colors</th></tr>
<tr><td>30</td><td>Black</td></tr>
<tr><td>31</td><td>Red</td></tr>
<tr><td>32</td><td>Green</td></tr>
<tr><td>33</td><td>Yellow</td></tr>
<tr><td>34</td><td>Blue</td></tr>
<tr><td>35</td><td>Magenta (Pink)</td></tr>
<tr><td>36</td><td>Cyan (Turquoise</td></tr>
<tr><td>37</td><td>White</td></tr>
<tr><td>38</td><td>Black</td></tr>
</table>

<table cellspacing= 5 border=1><tr><th colspan=2>Background colors</th></tr>
<tr><td>40</td><td>Black</td></tr>
<tr><td>41</td><td>Red</td></tr>
<tr><td>42</td><td>Green</td></tr>
<tr><td>43</td><td>Yellow</td></tr>
<tr><td>44</td><td>Blue</td></tr>
<tr><td>45</td><td>Magenta (Pink)</td></tr>
<tr><td>46</td><td>Cyan (Turquoise</td></tr>
<tr><td>47</td><td>White</td></tr>
<tr><td>48</td><td>Black</td></tr>
</table>
/

p The foreground color can be normal or highlighted. A numeric escape value of <b>1</b> highlights the foreground
  text color. For example, the <b>1</b> after the '[' turns on highlighting below.

T
l &nbsp;&nbsp;ESC = '1B'x
l &nbsp;&nbsp;call charout , ESC'[1;33;40m' || 'Hello'
/
p A numeric escape value of <b>0</b> deactivates highlighting.
  For example, the <b>0</b> after the '[' turns off highlighting below.

T
l &nbsp;&nbsp;ESC = '1B'x
l &nbsp;&nbsp;call charout , ESC'[0;33;40m' || 'Hello'
/
p No other ANSI.SYS escape sequences are emulated.

A Changestr
l The <b>Changestr</b> builtin function is provided for compatibility with
  other REXX implementations. There are <b>2</b> variants of the <i>Changestr</i> function -- <b>ANSI</b>
  and <i>NetRexx/Roo!&#153;</i>. By default <b>r4&#153;</b> supports the <b>ANSI</b> variant. The <i>NetRexx/Roo!(TM)</i>
  variant can be optionally activated by setting the <b>R4_ANSI</b> environment variable to <b>No</b>.
p The syntax of the function variants is:

T
l &nbsp;<strong>result = <b>Changestr</b>( needle, haystack, replacement )</strong> [<b>ANSI</b> variant]
/

T
l &nbsp;<strong>result = <b>Changestr</b>( haystack, needle, replacement )</strong> [<i>NetRexx/Roo!(TM)</i> variant]
/

p The result of the <i>Changestr</i> function replaces all non-overlapping occurrences of <i>needle</i> in
  <i>haystack</i> with <i>replacement</i>. When <i>needle</i> is the empty string, then the result is <i>haystack</i>.

p The following examples illustrate the operation of the <i>Changestr</i> function. The parenthesized
  value following the <b>say</b> keyword is the result of the associated <i>Changestr</i> function request.
  In these examples, only the <b>ANSI</b> variant is illustrated 

X
<pre>
  say '(dabracaddabra)' changestr( 'abra', 'abracadabra', 'dabra' )

  say '(abracadabra)'   changestr( '', 'abracadabra', 'dabra' )

</pre>
/

A Countstr
l The <b>Countstr</b> builtin function is provided for compatibility with
  other REXX implementations. There are <b>2</b> variants of the <i>Countstr</i> function -- <b>ANSI</b>
  and <i>NetRexx/Roo!&#153;)</i>. By default <b>r4&#153;</b> supports the <b>ANSI</b> variant. The <i>NetRexx/Roo!&#153;</i>
  variant can be optionally activated by setting the <b>R4_ANSI</b> environment variable to <b>No</b>.
p The syntax of the function variants is:

T
l &nbsp;<strong>result = <b>Countstr</b>( needle, haystack )</strong> [<b>ANSI</b> variant]
/

T
l &nbsp;<strong>result = <b>Countstr</b>( haystack, needle )</strong> [<i>NetRexx/Roo!&#153;</i> variant]
/

p The result of the <i>Countstr</i> function counts all non-overlapping occurrences of <i>needle</i> in
  <i>haystack</i>. When <i>needle</i> is the empty string, then the result is <i>0</i>.

p The following examples illustrate the operation of the <i>Countstr</i> function. The parenthesized
  value following the <b>say</b> keyword is the result of the associated <i>Countstr</i> function request.
  In these examples, only the <b>ANSI</b> variant is illustrated 

X
<pre>
  say '(2)' Countstr( 'abra', 'abracadabra' )

  say '(0)' Countstr( '', 'abracadabra' )

</pre>
/

l The <b>Find</b> builtin function is provided for compatibility with
  other REXX implementations. The function syntax is:

T
l &nbsp;<strong>result = Find( string, word )</strong>
/
p The <b>Find</b> builtin function is identical in operation to the <b>Wordpos</b> builtin function, with the
  exception that the <i>string</i> and <i>word</i> arguments are in the opposite order.

l The <b>Index</b> builtin function is provided for compatibility with
  other REXX implementations. The function syntax is:

T
l &nbsp;<strong>result = Index( haystack, needle [ , start ] )</strong>
/
p The <b>Index</b> builtin function is identical in operation to the <b>Pos</b> builtin function, with the
  exception that the <i>haystack</i> and <i>needle</i> arguments are in the opposite order.

l The <b>Justify</b> builtin function is provided for compatibility with
  other REXX implementations. The function syntax is:

T
l &nbsp;<strong>result = <b>Justify</b>( string, length [ , pad ] )</strong>
/

p The result of the <i>Justify</i> function always returns a string with length: <i>length</i>. There
  is always at least one word in the result, which might be truncated (as in the first example below).
  When more than one word is present in the result, the last word is not truncated. Spaces are added
  between the words as necessary to produce a result that has the requested length. If specified
  <i>pad</i> characters are added instead of spaces.

p The following examples illustrate the operation of the <i>Justify</i> function. The parenthesized
  value following the <b>say</b> keyword is the result of the associated <i>Justify</i> function request.

X
<pre>
  say '(Hooptedoo)'               justify( 'Hooptedoodle!', 9 )

  say '(The  blue)'               justify( 'The blue sky', 9 )

  say '(The++blue)'               justify( 'The blue sky', 9, '+' )

  say '(The++++)'                 justify( 'The blue sky', 7, '+' )

  say '(The++blue++sky)'          justify( 'The blue sky', 14, '+' )

  say '(The++blue+++sky)'         justify( 'The blue sky', 15, '+' )

  say '(The++azure+++blue+++sky)' justify( 'The azure blue sky', 23, '+' )

  say '(The blue)'                justify( 'The blue sky', 8 )

  say '(++++)'                    justify( '', 4, '+' )

  say '()'                        justify( '', 0 )

  say '()'                        justify( 'The blue sky', 0 )
</pre>
/

l The <b>Linesize</b> builtin function is provided for compatibility with
  other REXX implementations. The function syntax is:

T
l &nbsp;<strong>result = <b>Linesize</b>(&nbsp;)</strong>
/

p The result of the <i>Linesize</i> function is the number of characters per console line -- i.e. 80.

l The <b>Qualify</b> builtin function is provided for compatibility with
  other REXX implementations. The function syntax is:

T
l &nbsp;<strong>result = <b>Qualify</b>( [ streamName ] )</strong>
/

p The result of the <i>Qualify</i> function is the fully qualified name of <i>streamName</i>, in UPPERCASE.
  The empty string is returned if <i>streamName</i> is absent, or an empty string.

p The following examples illustrate the operation of the <i>Justify</i> function. The parenthesized
  value following the <b>say</b> keyword is the result of the associated <i>Justify</i> function request.

X
<pre>
  -- assume these are executed in the C:\R4 directory (folder)

  say '(C:\R4\R4.EXE)'   qualify( 'r4.exe' )

  say '(C:\R4\R4.EXE)'   qualify( './r4.exe' )

  say '(C:\R4\R4.EXE)'   qualify( '.\r4.exe' )

  say '()'               qualify( '' )

  call qualify nonExistentFileName --&gt; <b>syntax error !!!</b>
</pre>
/

l The <b>Scrsize</b> builtin function is provided for compatibility with
  other REXX implementations. The function syntax is:

T
l &nbsp;<strong>result = <b>Scrsize</b>(&nbsp;)</strong>
/

p The result of the <i>Scrsize</i> function is two numbers separated by a space. The first number is
  the number of console lines (i.e. 24), the second number is the number of characters per console line
  (i.e. 80).

l The <b>Userid</b> builtin function is provided for compatibility with
  other REXX implementations. The function syntax is:

T
l &nbsp;<strong>result = <b>Userid</b>(&nbsp;)</strong>
/
p The <i>result</i> is set to: ComputerName/Userid

t The following is an example of the operation of the <i>Userid</i> function.

X
<pre>
  parse value userid() with ComputerName '/' UserName
  say 'Hello' UserName'.'
  say 'Your computer name is:' ComputerName'.'
</pre>
/

/

l The following commands are performed within <b>r4</b>. The modifications associated with these
  are effective within <b>r4's</b> execution scope. When <b>r4</b> returns the prior state is
  automatically restored.

T
l <b>x:</b>^disk change, where: 'x' is a drive letter
l <b>CD</b> directoryPath^change directory
l <b>CHDIR</b> directoryPath^change directory
l <b>SET</b> environmentVariable'='value^set environment variable value
/
p The above commands should be properly quoted. Otherwise, backslashes within directory paths
  are treated as REXX <b>not</b> operators, and the '=' sign in a SET command is a relational
  operator.

l The default input stream and default output stream are connected to the standard Microsoft&#174; Windows&#174;
  files that are identified as <b><em>stdin</em></b> and <b><em>stdout</em></b> respectively.
  This allows your REXX programs to operate with redirected files, and participate in command pipelines.
  Consult Microsoft&#174; Windows&#174; documentation for the use of file redirection and command pipelines.
  
A FileRedirection
p The following shows how a COPYFILE program can be used with redirected files:

T
l &nbsp;&nbsp;<strong>r4 COPYFILE &lt; infile &gt; outfile</strong>
/

A CommandPipeline
p The following shows how the lines of the DIR command can be counted:

T
l &nbsp;&nbsp;<strong>DIR /b *.rex | r4 COUNTLINES</strong>
/

p The associated programs follow:
X style='font-weight:bold'
l /* COPYFILE.REX -- character version */
l do while chars() > 0
l &nbsp;&nbsp;call charout , charin()
l &nbsp;&nbsp;end
/

X style='font-weight:bold'
l /* COPYFILE.REX -- lines version */
l do while lines() > 0
l &nbsp;&nbsp;call lineout , linein()
l &nbsp;&nbsp;end
/

X style='font-weight:bold'
l /* COUNTLINES.REX -- unredirected version */
l lno = 0
l do while lines() > 0
l &nbsp;&nbsp;lin = linein()
l &nbsp;&nbsp;lno = lno + 1
l &nbsp;&nbsp;end
l say lno
/

X style='font-weight:bold'
l /* COUNTLINES.REX -- redirected or pipeline version */
l say lines()
/

l <b>'console'</b> is a special stream name. Stream builtin functions that access the <b>'console'</b> stream
  interact with the Microsoft&#174; Windows&#174; command console. A single exclamation point ('!') is an abbreviated
  alias for the <b>'console'</b> stream.

p The following is a simple program that interacts with the console user:

X style='font-weight:bold'
l /* GREET.REX */
l call charout !, "Please enter your name: "
l call lineout !, 'Hello' linein( ! )
/

p Notice that the exclamation point does not require quotes.

l The CHARS and LINES functions operate differently, depending on whether input is being typed
  from the keyboard, or received from a file.
 
p When the default input stream is not redirected from a file (or pipeline),
  the CHARS and LINES functions both return '1' when more input is available, and '0' when the end of
  the input stream is encountered.

p When the default input stream is redirected from a file (or pipeline),
  the CHARS and LINES functions return the actual number of
  characters or lines remaining in the stream.
  
p For file streams
  the CHARS and LINES functions return the actual number of
  characters or lines remaining in the stream.

p For the 'console' stream
  the CHARS and LINES functions both return '1' when more input is available, and '0' when the end of
  the input stream is encountered.
  The only difference is that the order of the first two arguments is reversed.

l The <b>MAKEBUF</b>, <b>DROPBUF</b>, <b>NEWSTACK</b>, and <b>DELSTACK</b> commands are builtin into
  the <b>r4</b> command environment. These builtin commands are provided for compatibility with
  other REXX implementations; such as, IBM's MVS TSO and VM implementations. All of these commands
  have no additional arguments.

p If you are a new REXX programmer you can skip the description of these capabilities.

p With respect to the <b>MAKEBUF</b>, <b>DROPBUF</b>, <b>NEWSTACK</b>, and <b>DELSTACK</b> commands, the
  external data queue is divided into a sequence of stacks, each of which can contain a sequence
  of buffers. Initially there is a single stack that contains a single buffer.

p A <b>NEWSTACK</b> command establishes a new stack division within the external data queue.
p A <b>MAKEBUF</b> command establishes a new buffer position within a stack division. Subsequent
  <b>QUEUE</b> requests will insert lines after a buffer position, but before all other lines
  within that buffer. A <b>QUEUED</b> builtin function request returns the number of lines that
  follow a buffer position.

p The following diagram shows how the external data queue is divided into stack divisions
  and buffers.

c <img src=stackBuff.gif>
  
p A <b>DROPBUF</b> request removes a buffering position established by a prior <b>MAKEBUF</b> command.

p Similarly, a <b>DELSTACK</b> request removes all lines from the top of the
  external data queue to a stack division point, only if a prior <b>NEWSTACK</b>
  division is established. If a prior <b>NEWSTACK</b> division was not established, then
  a <b>DELSTACK</b> request is ignored -- all lines in the external data queue remain.
  
p <b>PUSH</b> requests are unaffected by any of these commands. Pushed lines are always added at
  the last position of the external data queue.

p The <b>MAKEBUF</b> command returns a queue position, which is assigned to the RC variable.
  This queue position can optionally be passed
  to the <b>DROPBUF</b> command. The following shows how to use the queue position.

x
<pre>
  push z
  makebuf
  queue c
  makebuf
  queuePosition = rc
  queue a
  queue b
  dropbuf queuePosition
  queue x
  queue y
  say "Output lines to the marked position should appear in order: a, b, c, x, y"
  do queued()
    pull qline
    say qline
    end
  dropbuf
  say "The final queued line should be: z"
  do queued()
    pull qline
    say qline
    end
</pre>
/
/
-
A R4XFORM

+ R4 to EXE transform program (<b>R4XFORM</b>)
p The <b>R4XFORM</b> program allows you to create executable modules (EXEs) that encapsulate your
  REXX programs. The created modules can then be performed at command prompts, within batch scripts,
  or DOSKEY macros.

+ Usage, <b>R4XFORM</b>:
p The <b>R4XFORM</b> program operates as a standard Microsoft&#174; Windows&#174; application. The following is
  the syntax of an <b>R4XFORM</b> program request, that is entered as a DOS command prompt.

T
l &nbsp;&nbsp;<strong>R4XFORM [moduleName]</strong>
/

p Within this line, <strong>R4XFORM</strong> is a request to execute the <b>R4XFORM</b> program,
  which has a file name R4XFORM.EXE. You should add the directory that contains R4XFORM.EXE to your
  system PATH environment variable. See the <a href=#EnvironmentSetup>environment</a> setup
  section to determine how to revise the PATH environment variable.

p The optional <b>moduleName</b> argument is specified when you want to revise a previously created
  <b>R4XFORM</b> executable module. Spaces are not permitted in the <b>moduleName</b> argument. 
-

+ <b>R4XFORM</b> input fields
D
d <u>M</u>odule name
t This is the name of the executable module that encapsulates the R4 program. This name will
  always appear in upper case. A '.EXE' extension will automatically be added to the end of the
  module name.

p Spaces should NOT be entered in the <b>Module name</b> field.

d R4 source <u>p</u>rogram
t This is the name of the REXX program that will be performed when the module is executed.
  This program name will be passed as the <b>programName</b> argument as described in the
  <a href="#Usage">R4 Usage</a> section above.

p The 'Search' button on the right side of this input field allows you to use the system file
  explorer to locate the R4 source program.

p Spaces should NOT be entered in the <b>R4 source program</b> field. If there are spaces in
  the directory path that you located with the 'Search' button, then you should move the
  leading directory name to the R4PATH input field.

d Leading <u>a</u>rguments
t This is an <em>optional</em> field. The text that is entered in this field is passed as the
  <b>argumentText</b> of the <b>r4</b> command. You can specify additional arguments
  when you invoke the executable module.

d Working <u>d</u>irectory
t The text you enter in this field identifies the initial working directory that will be established
  when you invoke the executable module.

p The 'Search' button on the right side of this input field allows you to use the system folder
  search facility to locate an existing directory.

d <u>R</u>4PATH
t This is an <em>optional</em> field. The text in this field identifies the <b>R4PATH</b>
  environment variable that is used when you invoke the executable module. Otherwise, the
  prevailing <b>R4PATH</b> environment variable setting will be used.
  See the <a href="#EnvironmentVariables">environment variables</a> section above for a description
  of the <b>R4PATH</b> environment variable.

d <u>L</u>ine terminators
t This is an <em>optional</em> field. The text in this field identifies the <b>R4LINEBREAK</b>
  environment variable that is used when you invoke the executable module. Otherwise, the
  prevailing <b>R4LINEBREAK</b> environment variable setting will be used.
  See the <a href="#EnvironmentVariables">environment variables</a> section above for a description
  of the <b>R4LINEBREAK</b> environment variable.
/

p The underlined characters above are accelerator keys. When you hold down the 'Alt' key, and press
  one of the underlined characters the cursor will move to the associated input field.

p The 'OK' button is disabled until the module name AND the R4 source program AND the working
  directory field ALL contain text.
-
+ An <b>R4XFORM</b> example
p Here is an example of how to convert an R4 program to an executable module.

p The following is a simple program that shows a greeting.

X style='font-weight:bold'
l /* GREET.REX */
l say 'Hello' arg( 1 )
/

D
d <u>M</u>odule name
t GREET
d R4 source <u>p</u>rogram
t greet.rex
d Leading <u>a</u>rguments
t Pat (this may be empty)
d Working <u>d</u>irectory
t c:\r4
d <u>R</u>4PATH
t c:\r4 (normally this is empty)
d <u>L</u>ine terminators
t \r\n (normally this is empty)
/
p After you click the OK button, look in the same
  directory as the <b>R4XFORM</b> program, and you will observe that a new GREET.EXE file exists.

p Start a command prompt window. Switch to the directory that contains the program. Then enter:
X
l greet
/
b The following output appears:
X
l Hello Pat
/
p If instead you enter:
X
l greet -- Have a nice day !
/
b The following output appears:
X
l Hello Pat -- Have a nice day !
/
-
+ How <b>R4XFORM</b> works
p In order to use <b>R4XFORM</b> effectively you need to understand how it works.
  Perhaps you believe that <b>R4XFORM</b> compiled the REXX program into an executable module.
  This is not the case. <b>R4XFORM</b> works as follows:
O
l There is a module named TEENSY.EXE that is in the same directory as R4XFORM.EXE. The GREET.EXE
  file that was created above is a copy of TEENSY.EXE, with a different file name.

l The copied TEENSY.EXE module invokes another module called BECOME.EXE that is in the same
  directory. All of the arguments that were passed to TEENSY are passed onward to BECOME.

l <b>R4XFORM</b> prepares registry information which is processed by BECOME.EXE to determine
  how to perform the GREET program. The registry information is stored with the following keys:
p &nbsp;&nbsp;\\HKEY_LOCAL_MACHINE\Software\Kilowatt Software\Become\GREET
p And,
p &nbsp;&nbsp;\\HKEY_LOCAL_MACHINE\Software\Kilowatt Software\Become\GREET\Environment
p You can use the standard system registry editor to see the information that was created.
  You can start this program by Selecting 'Run' from the 'Start' menu, and entering the command REGEDIT.
  Search downwards through the registry tree for the path shown above. You will locate the
  registry information that was prepared for the GREET program.

l BECOME.EXE does the following:
O
l Determines the registry key from the arguments that are passed by GREET.EXE
l Acquires the registry information 
l Establishes the working directory
l Prepares environment settings for R4PATH and R4LINEBREAK if these were defined
l Prepares the command
l Adds the arguments that were passed onward to GREET.EXE to the command
l Performs the command
/
/
p If you comprehend the above process you will find that you can use the combination
  of TEENSY.EXE and BECOME.EXE to encapsulate other command shells as well.
  These two programs are not directly interrelated with <b>r4&#153;</b> or the <b>R4XFORM</b> program.
-
A Revu
+ Text file viewing program --<b>Revu&#153;</b>
p <b>r4&#153;</b> is accompanied by the <b>Revu&#153;</b> text file viewing accessory. This related
  product is particularly helpful when viewing Rexx source files. It is similarly useful for
  viewing C/C++, Java, JavaScript, Perl, XML and HTML files.
  <a href='revu.htm'>Click here</a> to study the related <b>Revu&#153;</b> program.
p <b>Revu&#153;</b> is implicitly used by <b>r4&#153;</b> for source presentation
  during interactive tracing. The current line is continually updated, as the program is debugged. When
  the program being debugged concludes, the associated <b>Revu&#153;</b> window is automatically closed.
-

-
A ProductUpdates
+ Product updates:
p When <b>r4&#153;</b> is updated, the latest version of <b>R4.EXE</b> and
  the updated User's Guide <b>R4.HTM</b> can be found in the following
  internet location:
b  <a href="http://www.kilowattsoftware.com/latest/">http://www.kilowattsoftware.com/latest/</a>
p REXX programming examples may be found in the same location. These are files that have
  a '.rex' extension.
; b  http://www.kilowattsoftware.com/rexx
; p You can contribute REXX programs
;   that you want to share with others in the REXX community by sending these to:
; b  contributions@kilowattsoftware.com
-
A Support
+ Support:
p If you have comments, questions, or concerns regarding <b>r4&#153;</b>
  you can send these via e-mail to:
c <a href=mailto:r4support@kilowattsoftware.com>E-Mail: r4support@kilowattsoftware.com</a>

c Enjoy <b>r4&#153;</b>, and start REXXing !
-
<hr width=40% align=center>

<div align=center>Kilowatt Software L.L.C. also offers:</div>
<div align=center>
<a href="http://www.kilowattsoftware.com/PoofPage.htm">Poof!&#153; -- A collection of Microsoft&#174; Windows&#174; command line utilities</a>
</div>
<div align=center>
<a href="http://www.kilowattsoftware.com/AuroraWarePage.htm">AuroraWare!&#153; -- A collection of helpful Microsoft&#174; Windows&#174; visual accessories</a>
</div>

<hr width=40% align=center>

c <img src=r4tmark.gif>
c REXX Language Level 4.00
c Build date: 7 Jul 2005
c Copyright &copy; 2001-2005
c All Rights Reserved.
c Web: <A HREF="http://www.kilowattsoftware.com/">http://www.kilowattsoftware.com/</A>
c <a href="mailto:r4support@kilowattsoftware.com">E-Mail: r4support@kilowattsoftware.com</a>
b
i kws32.gif align=left
i kws32.gif align=right
